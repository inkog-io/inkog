# Example: Inkog Security Scan Workflow
#
# This is an example workflow showing how to integrate Inkog into your CI/CD pipeline.
# Copy this file to your repository's .github/workflows/ directory.
#
# For more examples, see: https://docs.inkog.io/github-action

name: AI Agent Security Scan

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

permissions:
  contents: read
  security-events: write  # Required for SARIF upload
  pull-requests: write    # Required for PR comments

jobs:
  security-scan:
    runs-on: ubuntu-latest
    name: Scan AI Agents

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      # Basic scan - scans current directory with default settings
      - name: Run Inkog Security Scan
        uses: inkog-io/inkog@v1
        with:
          path: '.'
          policy: 'balanced'
          fail-on-findings: 'true'
          comment-on-pr: 'true'
          sarif-upload: 'true'

      # The action outputs can be used in subsequent steps
      - name: Check scan results
        if: always()
        run: |
          echo "Findings: ${{ steps.scan.outputs.findings-count }}"
          echo "Critical: ${{ steps.scan.outputs.critical-count }}"
          echo "Risk Score: ${{ steps.scan.outputs.risk-score }}"
